# Ansible managed - Standard Notes IaC
# Traefik v3.0 configuration

global:
  checkNewVersion: false
  sendAnonymousUsage: false

# Entry points
entryPoints:
  web:
    address: ":80"
  websecure:
    address: ":443"

# Docker provider
providers:
  docker:
    endpoint: "unix:///var/run/docker.sock"
    exposedByDefault: false
    network: standardnotes_self_hosted

# Certificate resolvers
certificatesResolvers:
  cloudflare:
    acme:
      email: "{{ app_service_letsencrypt_email }}"
      storage: /acme.json
      dnsChallenge:
        provider: cloudflare
        delayBeforeCheck: 30
        resolvers:
          - "1.1.1.1:53"
          - "8.8.8.8:53"

# API and dashboard (disabled for security)
api:
  dashboard: false
  insecure: false

# Health check endpoint
ping:
  entryPoint: "web"

# Logging
log:
  level: INFO
  format: json

# Access logs
accessLog:
  format: json
  fields:
    defaultMode: keep
    headers:
      defaultMode: drop
