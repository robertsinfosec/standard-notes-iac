# Ansible managed - Standard Notes IaC
# Standard Notes environment configuration

# Mode configuration
MODE=self-hosted

# Domain configuration
DOMAIN={{ app_service_domain }}
API_DOMAIN={{ app_service_api_domain }}

# CORS configuration (allow web frontend to access API backend)
CORS_ALLOWED_ORIGINS=https://{{ app_service_domain }}

# Cookie configuration (allow session cookies across subdomains)
COOKIE_DOMAIN=.{{ app_service_domain }}
COOKIE_SAME_SITE=None
COOKIE_SECURE=true
COOKIE_PARTITIONED=false

# Database configuration
DB_HOST=db
DB_PORT=3306
DB_DATABASE={{ app_service_mysql_database }}
DB_USERNAME={{ app_service_mysql_user }}
DB_PASSWORD={{ app_service_mysql_password }}
DB_DEBUG_LEVEL=info
DB_TYPE=mysql

# Redis cache configuration
REDIS_URL=redis://cache:6379
REDIS_HOST={{ app_service_redis_host }}
REDIS_PORT={{ app_service_redis_port }}
CACHE_TYPE=redis

# Encryption and authentication
AUTH_JWT_SECRET={{ app_service_auth_jwt_secret }}
ENCRYPTION_SERVER_KEY={{ app_service_encryption_server_key }}
AUTH_SERVER_ENCRYPTION_SERVER_KEY={{ app_service_encryption_server_key }}
VALET_TOKEN_SECRET={{ app_service_valet_token_secret }}

# Localstack configuration (SNS/SQS emulation)
# AWS credentials (for Localstack)
AWS_ACCESS_KEY_ID=test
AWS_SECRET_ACCESS_KEY=test

# Auth service SNS/SQS
AUTH_SERVER_SNS_TOPIC_ARN=arn:aws:sns:us-east-1:000000000000:auth-local-topic
AUTH_SERVER_SNS_AWS_REGION=us-east-1
AUTH_SERVER_SQS_QUEUE_URL=http://localstack:4566/000000000000/auth-local-queue
AUTH_SERVER_SQS_AWS_REGION=us-east-1

# Syncing service SNS/SQS
SYNCING_SERVER_SNS_TOPIC_ARN=arn:aws:sns:us-east-1:000000000000:syncing-server-local-topic
SYNCING_SERVER_SNS_AWS_REGION=us-east-1
SYNCING_SERVER_SQS_QUEUE_URL=http://localstack:4566/000000000000/syncing-server-local-queue
SYNCING_SERVER_SQS_AWS_REGION=us-east-1

# Files service SNS/SQS
FILES_SERVER_SNS_TOPIC_ARN=arn:aws:sns:us-east-1:000000000000:files-local-topic
FILES_SERVER_SNS_AWS_REGION=us-east-1
FILES_SERVER_SQS_QUEUE_URL=http://localstack:4566/000000000000/files-local-queue
FILES_SERVER_SQS_AWS_REGION=us-east-1

# Revisions service SNS/SQS
REVISIONS_SERVER_SNS_TOPIC_ARN=arn:aws:sns:us-east-1:000000000000:revisions-server-local-topic
REVISIONS_SERVER_SNS_AWS_REGION=us-east-1
REVISIONS_SERVER_SQS_QUEUE_URL=http://localstack:4566/000000000000/revisions-server-local-queue
REVISIONS_SERVER_SQS_AWS_REGION=us-east-1

# Application URLs
PUBLIC_FILES_SERVER_URL=https://{{ app_service_api_domain }}/files

# Container timezone
TZ={{ common_timezone }}

# SMTP configuration (optional)
{% if app_service_smtp_host %}
SMTP_HOST={{ app_service_smtp_host }}
SMTP_PORT={{ app_service_smtp_port }}
SMTP_USERNAME={{ app_service_smtp_username }}
SMTP_PASSWORD={{ app_service_smtp_password }}
SMTP_FROM_ADDRESS={{ app_service_smtp_from }}
{% endif %}

# Disable analytics
DISABLE_USER_REGISTRATION=false

# File upload settings
FILE_UPLOAD_PATH=/opt/standard-notes/uploads
